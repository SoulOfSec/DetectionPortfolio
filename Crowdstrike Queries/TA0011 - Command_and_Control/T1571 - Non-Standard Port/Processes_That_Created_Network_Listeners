/*
Description:
Correlates process creation events with network listeners on privileged ports, identifying unexpected processes opening listening sockets (possible backdoors or reverse shells).

MITRE Mapping:
TA0011 â€“ Command and Control
*/

#event_simpleName = ProcessRollup2
| join({#event_simpleName = NetworkListenIP4 LocalPort < 1024 LocalPort != 0}, field = TargetProcessId, key = ContextProcessId, include = [LocalAddressIP4, LocalPort])
